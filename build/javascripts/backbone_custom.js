var Workspace=Backbone.Router.extend({routes:{"about-project":"fnOne","personal-details":"fnTwo","thank-you":"fnThree",2:"fnOne",3:"fnTwo","":"initial"},initial:function(){$(".inner-box").css({"z-index":"2"}).removeClass("animated fade-in"),$(".overlay-up").removeClass("open"),$("body").removeClass("overflow-H"),$(".main-form").removeClass("openForm-model")},fnOne:function(){enquiries.set("currentPage",1),$(".inner-box").css({"z-index":"2"}).removeClass("animated fade-in"),form.setElement("#firstForm"),$("#firstForm").parent().css({"z-index":"3"}).addClass("animated fade-in"),$(".overlay-up").addClass("open"),$("body").addClass("overflow-H"),$(".main-form").addClass("openForm-model")},fnTwo:function(){enquiries.set("currentPage",2),$(".inner-box").css({"z-index":"2"}).removeClass("animated fade-in"),form.setElement("#secondForm"),$("#secondForm").parent().css({"z-index":"3"}).addClass("animated fade-in")},fnThree:function(){enquiries.set("currentPage",3),$(".inner-box").css({"z-index":"2"}).removeClass("animated fade-in"),form.setElement("#thirdForm"),$("#thirdForm").parent().css({"z-index":"3"}).addClass("animated fade-in")}}),Enquiries=Backbone.Model.extend({defaults:{currentPage:1,optionNone:"",subOptionNone:"",objective:"",attachLink:"",clientName:"",company:"",email:"",mobileNumber:""}}),enquiries=new Enquiries,validationFlag=!1;window.enquiries=enquiries;var FormView=Backbone.View.extend({el:$(".inner-box"),events:{"click .back":"prevPage","click .next":"nextPage","click .send":"sendPage","click .checkgroup":"clicked","change input#files":"fileUpload","keyup .textField":"enterHandler"},model:enquiries,enterHandler:function(e){13==e.keyCode&&this.nextPage()},clicked:function(e){var a=$(e.target);a.is(":checkbox")||(a=a.find("input:checkbox"));var n=(a.is(":checked"),a.val());return n},prevPage:function(){this.modelUpdate();var e=this.model.get("currentPage");2==e?workspace.navigate("about-project",{trigger:!0,replace:!0}):3==e&&workspace.navigate("personal-details",{trigger:!0,replace:!0})},nextPage:function(e){e.preventDefault();var a=[];$("#projectType input:checkbox:checked").map(function(){a.push($(this).next("label").find(".name").text())}),$("#optionNone").val(a);var n=[];$("#SubOption input:checkbox:checked").map(function(){n.push($(this).next("label").find(".box2 .small-name").text())}),$("#subOptionNone").val(n),this.modelUpdate();var r=this.model.get("currentPage");this.shouldProceed()&&(r+=1,workspace.navigate(""+r,{trigger:!0}),2==r&&workspace.navigate("personal-details",{trigger:!0}),3==r&&workspace.navigate("thank-you",{trigger:!0,replace:!0}))},shouldProceed:function(){var e={1:function(){return enquiries.get("objective")?$("#objective").parent().removeClass("error"):($("#objective").addClass("animate"),$("#objective").parent().addClass("error")),enquiries.get("optionNone")?($("#optionNone").css("border","1px solid #757575"),!!enquiries.get("optionNone")):($("#optionNone").css("border","1px solid #db4344"),void enquiries.get("attachLink"))},2:function(){if($("#secondForm input").removeClass("animate"),!enquiries.get("clientName"))return $("#clientName").addClass("animate"),$("#clientName").parent().addClass("error"),!1;if($("#clientName").parent().removeClass("error"),!enquiries.get("company"))return $("#company").addClass("animate"),$("#company").parent().addClass("error"),!1;$("#company").removeClass("animate"),$("#company").parent().removeClass("error");var e=/^([\w-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([\w-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/,a=enquiries.get("email"),n=enquiries.get("mobileNumber");return e.test(a)?($("#email").removeClass("animate"),$("#email").parent().removeClass("error"),n?($("#mobileNumber").removeClass("animate"),$("#mobileNumber").parent().removeClass("error"),!0):($("#mobileNumber").addClass("animate"),$("#mobileNumber").parent().addClass("error"),!1)):($("#email").addClass("animate"),$("#email").parent().addClass("error"),!1)},3:function(){return!0}},a=e[enquiries.get("currentPage").toString()]();return validationFlag=a,a},sendPage:function(){validationFlag&&($(".send").addClass("active"),this.modelUpdate(),$.post("https://parallellabs.io/api/sendmail.php",enquiries.attributes).done(function(e){console.log("Response: ",e)}))},modelUpdate:function(){for(var e=this.$el.find(".group"),a=[],n=0;e[n];)a[n]=e[n++];a.forEach(function(e){enquiries.set($(e).find("input").attr("id"),$(e).find("input").val())}),enquiries.set(this.$el.find(".group textarea").attr("id"),this.$el.find(".group textarea").val())},fileUpload:function(e){var a=[];$.each(e.target.files,function(e,n){var r=new FileReader;r.onload=function(e){object={},object.path=e.target.result,console.log(object),a.push(object)},r.readAsDataURL(n)}),setTimeout(1e3,enquiries.set("attachments",a))},openForm:function(e){this.modelUpdate(),workspace.navigate("about-project",{trigger:!0,replace:!0})}});$(".open-form").click(function(){var e=enquiries.get("currentPage");e=e,workspace.navigate("about-project",{trigger:!0})}),$(".close-form").click(function(){var e=enquiries.get("currentPage");e=e,workspace.navigate("about-project",{trigger:!0})});var form=new FormView;window.workspace=new Workspace,Backbone.history.start({pushState:!1}),workspace.navigate("/");