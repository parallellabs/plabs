var Workspace=Backbone.Router.extend({routes:{1:"fnOne",2:"fnTwo",3:"fnThree"},fnOne:function(){enquiries.set("currentPage",1),$("#thirdForm").parent().css({"z-index":"2",opacity:"0"}),form.setElement("#firstForm"),$("#firstForm").parent().css({"z-index":"3",opacity:"1"}).addClass("animated zoomIn")},fnTwo:function(){enquiries.set("currentPage",2),$("#firstForm").parent().css({"z-index":"2",opacity:"0"}),form.setElement("#secondForm"),$("#secondForm").parent().css({"z-index":"3",opacity:"1"}).addClass("animated zoomIn")},fnThree:function(){enquiries.set("currentPage",3),$("#secondForm").parent().css({"z-index":"2",opacity:"0"}),form.setElement("#thirdForm"),$("#thirdForm").parent().css({"z-index":"3",opacity:"1"}).addClass("animated zoomIn")}}),Enquiries=Backbone.Model.extend({defaults:{currentPage:1,optionNone:"",subOptionNone:"",objective:"",attachLink:"",clientName:"",company:"",email:"",mobileNumber:""}}),enquiries=new Enquiries,validationFlag=!1;window.enquiries=enquiries;var FormView=Backbone.View.extend({el:$(".inner-box"),events:{"click .back":"prevPage","click .next":"nextPage","click .send":"sendPage","click .checkgroup":"clicked","change input#files":"fileUpload","keyup .textField":"enterHandler"},model:enquiries,enterHandler:function(e){13==e.keyCode&&this.nextPage()},clicked:function(e){var n=$(e.target);n.is(":checkbox")||(n=n.find("input:checkbox"));var i=(n.is(":checked"),n.val());return i},nextPage:function(e){e.preventDefault();var n=[];$("#projectType input:checkbox:checked").map(function(){n.push($(this).next("label").find(".name").text())}),$("#optionNone").val(n);var i=[];$("#SubOption input:checkbox:checked").map(function(){i.push($(this).next("label").find(".box2 .small-name").text())}),$("#subOptionNone").val(i),console.log("test"),this.modelUpdate();var t=this.model.get("currentPage");console.log(t+1),this.shouldProceed()&&(t+=1,workspace.navigate(""+t,{trigger:!0}))},shouldProceed:function(){var e={1:function(){return enquiries.get("objective"),enquiries.get("optionNone")?($("#firstForm .message").animate({opacity:"+0"}),$("#optionNone").css("border","1px solid #757575"),!!enquiries.get("optionNone")):($("#firstForm .message").animate({opacity:"+1"}),$("#optionNone").css("border","1px solid #db4344"),void enquiries.get("attachLink"))},2:function(){enquiries.get("clientName")?(console.log(enquiries.get("clientName")),$("#secondForm .message").animate({opacity:"+0"}),$("#clientName").css("border","1px solid #757575")):($("#secondForm .message").animate({opacity:"+1"}),$("#clientName").css("border","1px solid #db4344")),enquiries.get("company")?($("#secondForm .message").animate({opacity:"+0"}),$("#company").css("border","1px solid #757575")):($("#secondForm .message").animate({opacity:"+1"}),$("#company").css("border","1px solid #db4344")),enquiries.get("mobileNumber");var e=/^([\w-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([\w-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/,n=enquiries.get("email");enquiries.get("mobileNumber");return e.test(n)?($("#secondForm .message").animate({opacity:"+0"}),$("#email").css("border","1px solid #757575"),validationFlag=!0,!!enquiries.get("email")):($("#secondForm .message").animate({opacity:"+1"}),void $("#email").css("border","1px solid #db4344"))},3:function(){return!0}},n=e[enquiries.get("currentPage").toString()]();return console.log("returning ",n),n},sendPage:function(){console.log("returning-flag ",validationFlag),validationFlag&&(this.modelUpdate(),console.log(enquiries.attributes),$.post("http://205.186.143.136:5000/sendmail",enquiries.attributes).done(function(e){console.log("Response: ",e)}))},modelUpdate:function(){console.info("updating...");for(var e=this.$el.find(".group"),n=[],i=0;e[i];)n[i]=e[i++];console.info("New Groups",n),n.forEach(function(e){enquiries.set($(e).find("input").attr("id"),$(e).find("input").val())}),enquiries.set(this.$el.find(".group textarea").attr("id"),this.$el.find(".group textarea").val())},fileUpload:function(e){console.log(e);var n=[];$.each(e.target.files,function(e,i){var t=new FileReader;t.onload=function(e){object={},object.path=e.target.result,console.log(object),n.push(object)},t.readAsDataURL(i)}),setTimeout(1e3,enquiries.set("attachments",n))}}),form=new FormView;window.workspace=new Workspace,Backbone.history.start({pushState:!1}),workspace.navigate("1",{trigger:!0});