var Workspace=Backbone.Router.extend({routes:{1:"fnOne",2:"fnTwo",3:"fnThree",4:"fnFourth"},fnOne:function(){enquiries.set("currentPage",1),$(".inner-box").css("opacity","1"),$("#firstForm").removeClass("move-left"),$("#secondForm").removeClass("move-left"),$("#thirdForm").removeClass("move-left"),$("#fourthForm").removeClass("move-left"),$("#fifthForm").removeClass("move-left"),$("#sixthForm").removeClass("move-left"),form.setElement("#firstForm"),$("#secondForm").addClass("move-right"),$("#thirdForm").addClass("move-right"),$("#fourthForm").addClass("move-right"),$("#fifthForm").addClass("move-right"),$("#sixthForm").addClass("move-right")},fnTwo:function(){enquiries.set("currentPage",2),$("#secondForm").removeClass("move-right"),$("#secondForm").removeClass("move-left"),form.setElement("#secondForm"),$("#firstForm").addClass("move-left"),$("#thirdForm").addClass("move-right")},fnThree:function(){enquiries.set("currentPage",3),$("#thirdForm").removeClass("move-right"),$("#thirdForm").removeClass("move-left"),form.setElement("#thirdForm"),$("#secondForm").addClass("move-left"),$("#fourthForm").addClass("move-right")}}),Enquiries=Backbone.Model.extend({defaults:{currentPage:1,objective:"",attachLink:"",clientName:"",company:"",email:"",mobileNumber:""}}),enquiries=new Enquiries,validationFlag=!1;window.enquiries=enquiries;var FormView=Backbone.View.extend({el:$(".inner-box"),events:{"click .back":"prevPage","click .next":"nextPage","click .send":"sendPage","click .checkgroup":"clicked","change input#files":"fileUpload","keyup .textField":"enterHandler"},model:enquiries,enterHandler:function(e){13==e.keyCode&&this.nextPage()},clicked:function(e){var o=$(e.target);o.is(":checkbox")||(o=o.find("input:checkbox"));var i=(o.is(":checked"),o.val());return i},prevPage:function(){var e=this.model.get("currentPage");console.log(e-1),workspace.navigate(""+(e-1),{trigger:!0}),$(".group .message").animate({opacity:"+0"})},nextPage:function(){console.log("test"),this.modelUpdate();var e=this.model.get("currentPage");console.log(e+1),this.shouldProceed()&&(e+=1,workspace.navigate(""+e,{trigger:!0}),2==e&&($("#secondForm").parent().css({"z-index":"3"}),$("#secondForm").addClass("animated fadeIn")),3==e&&($("#thirdForm").parent().css("z-index","3"),$("#thirdForm").addClass("animated fadeIn")))},shouldProceed:function(){var e={1:function(){return enquiries.get("objective")?($(".group .message").animate({opacity:"+0"}),$("#objective").css("border","1px solid #757575"),!!enquiries.get("objective")):($(".group .message").animate({opacity:"+1"}),void $("#objective").css("border","1px solid #db4344"))},2:function(){enquiries.get("clientName")?(console.log(enquiries.get("clientName")),$(".group .message").animate({opacity:"+0"}),$("#clientName").css("border","1px solid #757575")):($(".group .message").animate({opacity:"+1"}),$("#clientName").css("border","1px solid #db4344")),enquiries.get("company")?($(".group .message").animate({opacity:"+0"}),$("#company").css("border","1px solid #757575")):($(".group .message").animate({opacity:"+1"}),$("#company").css("border","1px solid #db4344")),enquiries.get("mobileNumber")?($(".group .message").animate({opacity:"+0"}),$("#mobileNumber").css("border","1px solid #757575")):($(".group .message").animate({opacity:"+1"}),$("#mobileNumber").css("border","1px solid #db4344"));var e=/^([\w-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([\w-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/,o=enquiries.get("email"),i=/\(?([0-9]{3})\)?([ .-]?)([0-9]{3})\2([0-9]{4})/,t=enquiries.get("mobileNumber");return e.test(o)?($("#email").parents(".group").find(".message").animate({opacity:"+0"}),$("#email").css("border","1px solid #757575"),validationFlag=!0,!!enquiries.get("email")):($("#email").parents(".group").find(".message").animate({opacity:"+1"}),$("#email").css("border","1px solid #db4344"),void(i.test(t)?($("#mobileNumber").parents(".group").find(".message").animate({opacity:"+0"}),$("#mobileNumber").css("border","1px solid #757575")):($("#mobileNumber").parents(".group").find(".message").animate({opacity:"+1"}),$("#mobileNumber").css("border","1px solid #db4344"))))},3:function(){return!0}},o=e[enquiries.get("currentPage").toString()]();return console.log("returning ",o),o},sendPage:function(){console.log("returning-flag ",validationFlag),validationFlag&&(this.modelUpdate(),console.log(enquiries.attributes),$.post("http://205.186.143.136:5000/sendmail",enquiries.attributes).done(function(e){console.log("Response: ",e)}))},modelUpdate:function(){console.info("updating...");for(var e=this.$el.find(".group"),o=[],i=0;e[i];)o[i]=e[i++];console.info("New Groups",o),o.forEach(function(e){enquiries.set($(e).find("input").attr("id"),$(e).find("input").val())}),enquiries.set(this.$el.find(".group textarea").attr("id"),this.$el.find(".group textarea").val())},fileUpload:function(e){console.log(e);var o=[];$.each(e.target.files,function(e,i){var t=new FileReader;t.onload=function(e){object={},object.path=e.target.result,console.log(object),o.push(object)},t.readAsDataURL(i)}),setTimeout(1e3,enquiries.set("attachments",o))}}),form=new FormView;window.workspace=new Workspace,Backbone.history.start({pushState:!1}),workspace.navigate("1",{trigger:!0});